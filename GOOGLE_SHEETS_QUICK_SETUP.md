# –ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Google Sheets

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (5 —à–∞–≥–æ–≤)

### 1. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Google Cloud

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
3. –í–∫–ª—é—á–∏—Ç–µ **Google Sheets API** –∏ **Google Drive API**

### 2. –°–æ–∑–¥–∞–π—Ç–µ OAuth 2.0 credentials

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: `APIs & Services` ‚Üí `Credentials`
2. –ù–∞–∂–º–∏—Ç–µ `Create Credentials` ‚Üí `OAuth client ID`
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø: **Desktop app**
4. –°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª
5. –ü–µ—Ä–µ–∏–º–µ–Ω—É–π—Ç–µ –≤ `oauth_client.json` –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –±–æ—Ç–æ–º

### 3. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –≤ Google Drive (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Google Drive](https://drive.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Ç–∞–±–ª–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, "WorkLog Reports")
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –ø–∞–ø–∫–∏ –∏–∑ URL:
   ```
   https://drive.google.com/drive/folders/1AbCdEfGhIjKlMnOpQrStUvWxYz
                                          ^^^^^^^^^^^^^^^^^^^^^^^^
                                          –≠—Ç–æ DRIVE_FOLDER_ID
   ```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```env
# Google Sheets
OAUTH_CLIENT_JSON=oauth_client.json
TOKEN_JSON_PATH=token.json
DRIVE_FOLDER_ID=1AbCdEfGhIjKlMnOpQrStUvWxYz
EXPORT_PREFIX=WorkLog
AUTO_EXPORT_ENABLED=true
AUTO_EXPORT_CRON=0 9 * * 1
```

### 5. –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
python bot.py
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
1. –í–æ–π–¥–∏—Ç–µ –≤ Google –∞–∫–∫–∞—É–Ω—Ç
2. –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ Google Sheets –∏ Drive
3. –ó–∞–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä
4. –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `token.json`

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã –≤ Google Sheets
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
- ‚úÖ –£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü

–ö–∞–∂–¥—ã–π –º–µ—Å—è—Ü —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞:
- **–ù–∞–∑–≤–∞–Ω–∏–µ**: `WorkLog - –Ø–Ω–≤–∞—Ä—å 2025`
- **–õ–∏—Å—Ç**: `–û—Ç—á–µ—Ç—ã`
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è | User ID | –ò–º—è | –õ–æ–∫–∞—Ü–∏—è | –ì—Ä—É–ø–ø–∞ –ª–æ–∫–∞—Ü–∏–∏ | –í–∏–¥ —Ä–∞–±–æ—Ç—ã | –ì—Ä—É–ø–ø–∞ —Ä–∞–±–æ—Ç—ã | –î–∞—Ç–∞ —Ä–∞–±–æ—Ç—ã | –ß–∞—Å—ã

### –†—É—á–Ω–æ–π —ç–∫—Å–ø–æ—Ä—Ç

–ê–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç—ã –≤—Ä—É—á–Ω—É—é:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ WhatsApp
2. –ù–∞–∂–º–∏—Ç–µ `–ï—â—ë...` ‚Üí `–ê–¥–º–∏–Ω` ‚Üí `–≠–∫—Å–ø–æ—Ä—Ç`
3. –ë–æ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –Ω–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 9:00

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `.env`:
```env
AUTO_EXPORT_ENABLED=true
AUTO_EXPORT_CRON=0 9 * * 1
```

–§–æ—Ä–º–∞—Ç cron: `–º–∏–Ω—É—Ç–∞ —á–∞—Å –¥–µ–Ω—å –º–µ—Å—è—Ü –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏`

–ü—Ä–∏–º–µ—Ä—ã:
- `0 9 * * 1` - –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 9:00
- `0 0 1 * *` - 1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ –≤ 00:00
- `0 */6 * * *` - –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤

---

## ‚ùì Troubleshooting

### –û—à–∏–±–∫–∞: "credentials not found"

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞
ls -la oauth_client.json

# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –≤ .env –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
cat .env | grep OAUTH_CLIENT_JSON
```

### –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```bash
# –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π —Ç–æ–∫–µ–Ω –∏ –∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –∑–∞–Ω–æ–≤–æ
rm token.json
python bot.py
```

### –¢–∞–±–ª–∏—Ü—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
grep "SHEETS" bot.log
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Google Sheets API –∏ Google Drive API –≤–∫–ª—é—á–µ–Ω—ã –≤ Google Cloud Console.

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–í–∞–∂–Ω–æ!** –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ Git:
- `oauth_client.json`
- `token.json`
- `.env`

–î–æ–±–∞–≤—å—Ç–µ –≤ `.gitignore`:
```
oauth_client.json
token.json
.env
```

---

**–ì–æ—Ç–æ–≤–æ!** Google Sheets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞. üéâ

–í—Å–µ –æ—Ç—á–µ—Ç—ã —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Google Sheets.
