# üì¶ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã:
```
‚úÖ bot.py              - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª, –∑–∞–ø—É—Å–∫ Flask —Å–µ—Ä–≤–µ—Ä–∞ (3.4 KB)
‚úÖ config.py           - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ .env (1.5 KB)
‚úÖ webhook.py          - –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç 360dialog (3.3 KB)
‚úÖ menu_handlers.py    - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–µ–Ω—é –∏ –∫–æ–º–∞–Ω–¥ (8.3 KB)
‚úÖ requirements.txt    - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚úÖ .env               - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (—É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω –≤–∞—à–∏–º API –∫–ª—é—á–æ–º)
‚úÖ env.example        - –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
‚úÖ .gitignore         - –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è Git
```

### –ü–∞–ø–∫–∞ utils/:
```
‚úÖ utils/__init__.py   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚úÖ utils/state.py      - FSM (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏) (3.2 KB)
‚úÖ utils/api_360.py    - API –∫–ª–∏–µ–Ω—Ç –¥–ª—è 360dialog (6.5 KB)
‚úÖ utils/sheets.py     - Google Sheets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (TODO)
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
```
‚úÖ README.md           - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (7.8 KB)
‚úÖ QUICKSTART.md       - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (4.2 KB)
‚úÖ ARCHITECTURE.md     - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (8.9 KB)
‚úÖ PROJECT_SUMMARY.md  - –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

### –°—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏):
```
üìÑ bot_polya_whatsapp.py     - –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞ pywa
üìÑ README_WHATSAPP.md        - –°—Ç–∞—Ä–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
üìÑ SETUP_360DIALOG.md        - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ 360dialog
üìÑ requirements_whatsapp.txt - –°—Ç–∞—Ä—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ:
1. **Flask –≤–µ–±-—Å–µ—Ä–≤–µ—Ä** –Ω–∞ –ø–æ—Ä—Ç—É 8000
2. **Webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫** (GET/POST /webhook)
3. **API –∫–ª–∏–µ–Ω—Ç –¥–ª—è 360dialog:**
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–Ω–æ–ø–æ–∫ (–¥–æ 3 —à—Ç)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–ø–∏—Å–∫–æ–≤
4. **FSM (–º–∞—à–∏–Ω–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π):**
   - –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—à–∞–≥–æ–≤—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
5. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–µ–Ω—é:**
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
   - –ú–µ–Ω—é —Å–º–µ–Ω
   - –ú–µ–Ω—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
   - –ú–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–µ–∫
6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (–≤ —Ñ–∞–π–ª –∏ –∫–æ–Ω—Å–æ–ª—å)
7. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** –∏–∑ .env —Ñ–∞–π–ª–∞
8. **.gitignore** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
9. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (3 —Ñ–∞–π–ª–∞ MD)

### ‚ö†Ô∏è TODO (–∑–∞–≥–æ—Ç–æ–≤–∫–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏):
1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite/PostgreSQL)
2. Google Sheets –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (utils/sheets.py)
3. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
4. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã
5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (APScheduler)

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env:
```bash
cat .env
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
D360_API_KEY=DQSi7mQYdGwmx4rEqvnQRRJrAK ‚úÖ
D360_BASE_URL=https://waba-v2.360dialog.io ‚úÖ
VERIFY_TOKEN=terra_bot_verify_token_2024 ‚úÖ
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞:
```bash
python bot.py
```

### 4. –û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:8000
```

–î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å "‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç"

### 5. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook:

**–õ–æ–∫–∞–ª—å–Ω–æ (—Å ngrok):**
```bash
ngrok http 8000
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å HTTPS URL ‚Üí –≤—Å—Ç–∞–≤–∏—Ç—å –≤ 360dialog
```

**–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
```
https://–≤–∞—à-–¥–æ–º–µ–Ω.com/webhook
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ö–æ–¥:
- **–í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~600+ —Å—Ç—Ä–æ–∫
- **–§–∞–π–ª–æ–≤ Python:** 7
- **–ú–æ–¥—É–ª–µ–π:** 3 (–≤ utils/)
- **Endpoints:** 4 (/, /webhook GET/POST, /health)

### –§—É–Ω–∫—Ü–∏–∏:
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –º–µ–Ω—é:** 7
- **API –º–µ—Ç–æ–¥–æ–≤:** 4
- **FSM —Ñ—É–Ω–∫—Ü–∏–π:** 6

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- **README.md:** ~250 —Å—Ç—Ä–æ–∫
- **QUICKSTART.md:** ~150 —Å—Ç—Ä–æ–∫  
- **ARCHITECTURE.md:** ~350 —Å—Ç—Ä–æ–∫
- **–í—Å–µ–≥–æ:** ~750 —Å—Ç—Ä–æ–∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

```python
Flask 3.0.0           # –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
python-dotenv 1.0.0   # .env —Ñ–∞–π–ª—ã
requests 2.31.0       # HTTP –∫–ª–∏–µ–Ω—Ç
gspread 5.12.0        # Google Sheets
APScheduler 3.10.4    # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
```

## üé® –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
360dialog API
    ‚Üì
Flask (bot.py)
    ‚Üì
Webhook (webhook.py)
    ‚Üì
Router (menu_handlers.py)
    ‚Üì
‚îú‚îÄ State Manager (utils/state.py)
‚îú‚îÄ API Client (utils/api_360.py)
‚îî‚îÄ Sheets (utils/sheets.py)
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ webhook
- ‚úÖ .env –Ω–µ –≤ Git (.gitignore)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–æ–≤ (ADMIN_IDS)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- 1 –ø—Ä–æ—Ü–µ—Å—Å Flask (development)
- –°–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏ (dict)
- –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
- Gunicorn —Å 4+ worker'–∞–º–∏
- Redis –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
- PostgreSQL –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- Message Queue –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –∑–∞–ø—É—Å–∫–∞:
1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. ‚ö†Ô∏è –ò–∑–º–µ–Ω–∏—Ç—å ADMIN_IDS –≤ .env
3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç
4. ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –≤ 360dialog
5. ‚ö†Ô∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–æ—Ç—É "start"

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (SQLite)
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Google Sheets
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –º–µ–Ω—é
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É—á—ë—Ç —Å–º–µ–Ω
5. –î–æ–±–∞–≤–∏—Ç—å –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã

## üìû –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### Healthcheck:
```bash
curl http://localhost:8000/health
# ‚Üí {"status": "healthy", "service": "WhatsApp Bot 360dialog"}
```

### –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏:
```python
from utils.api_360 import send_text_message
send_text_message("79991234567", "–ü—Ä–∏–≤–µ—Ç!")
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π:
```python
from utils.state import get_all_states
print(get_all_states())
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **README.md** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- **QUICKSTART.md** - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –∑–∞ 5 –º–∏–Ω—É—Ç
- **ARCHITECTURE.md** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **PROJECT_SUMMARY.md** - —ç—Ç–æ—Ç —Ñ–∞–π–ª (–æ–±–∑–æ—Ä)

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ:
- ‚úÖ –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥–∏—á–Ω–∞—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è
- ‚úÖ .env –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –≤–∞—à–∏–º API –∫–ª—é—á–æ–º
- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω—ã
- ‚úÖ .gitignore –Ω–∞—Å—Ç—Ä–æ–µ–Ω

**–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å!** üöÄ

```bash
python bot.py
```

---

## üìù –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [x] –§–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [x] `D360_API_KEY` –∑–∞–ø–æ–ª–Ω–µ–Ω
- [ ] `ADMIN_IDS` –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ –≤–∞—à –Ω–æ–º–µ—Ä
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (`pip install -r requirements.txt`)
- [ ] –ü–æ—Ä—Ç 8000 —Å–≤–æ–±–æ–¥–µ–Ω
- [ ] Webhook –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ 360dialog

–£–¥–∞—á–∏! üçÄ

